{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nasync function servisePixabay(str, page = 1) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '42170319-af092c1d236dd53a733e41db9';\n  const params = new URLSearchParams({\n    key: API_KEY,\n    q: str,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: 15,\n  });\n\n  const { data } = await axios.get(`${BASE_URL}?${params}`);\n  return data;\n}\n\nexport { servisePixabay };\n","function createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        downloads,\n        views,\n        comments,\n        likes,\n        webformatURL,\n        tags,\n        largeImageURL,\n      }) =>\n        `<li class=\"gallery_item\">\n        <a class=\"gallery_link\" href=\"${largeImageURL}\">\n          <img class=\"gallery_img\" src=\"${webformatURL}\" data-sourse=\"${largeImageURL}\" alt=\"${tags}\" />\n        </a>\n        <ul class=\"gallery_item_params\">\n          <li class=\"gallery_item_params_link\">\n            <svg class=\"gallery_svg\" width=\"24\" height=\"24\">\n              <use href=\"../img/sprite.svg#icon-downloads\"></use>\n            </svg>\n            ${downloads}\n          </li>\n          <li class=\"gallery_item_params_link\">\n            <svg class=\"gallery_svg\" width=\"24\" height=\"24\">\n              <use href=\"../img/sprite.svg#icon-heart\"></use>\n            </svg>\n            ${likes}\n          </li>\n          <li class=\"gallery_item_params_link current\">\n            <svg class=\"gallery_svg\" width=\"24\" height=\"24\">\n              <use href=\"../img/sprite.svg#icon-search\"></use>\n            </svg>\n            ${views}\n          </li>\n          <li class=\"gallery_item_params_link current\">\n            <svg class=\"gallery_svg\" width=\"24\" height=\"24\">\n              <use href=\"../img/sprite.svg#icon-form-search\"></use>\n            </svg>\n            ${comments}\n          </li>\n          </ul>\n          </li>\n          `\n    )\n    .join('');\n}\n\n\nexport { createMarkup };","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { servisePixabay } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\n\nlet page = 1;\nlet searchInput = '';\n\nconst elements = {\n  searchForm: document.querySelector('#present_form'),\n  list: document.querySelector('.gallery'),\n  loadBtn: document.querySelector('.js-load-more'),\n  loaderWrapper: document.querySelector('.loader'),\n};\n\nfunction showLoader() {\n  elements.loaderWrapper.style.display = 'block';\n}\n\nfunction hideLoader() {\n  elements.loaderWrapper.style.display = 'none';\n}\nhideLoader();\nelements.searchForm.addEventListener('submit', onSearchClick);\n\nasync function onSearchClick(e) {\n  e.preventDefault();\n  searchInput = e.currentTarget.elements.fieldSearch.value;\n  if (!searchInput) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter a search query!',\n      position: 'topCenter',\n      backgroundColor: 'rgba(252, 249, 249, 1)',\n      messageColor: '#000',\n      zindex: '10000000',\n    });\n    return;\n  }\n  page = 1;\n  elements.list.innerHTML = '';\n  showLoader();\n  try {\n    const data = await servisePixabay(searchInput, page);\n    if (!data.hits.length) {\n      iziToast.show({\n        title: 'Error',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topCenter',\n        backgroundColor: 'rgba(252, 249, 249, 1)',\n        messageColor: '#000',\n        zindex: '10000000',\n      });\n    }\n    elements.list.innerHTML = createMarkup(data.hits);\n    const galleryList = new SimpleLightbox('.gallery a', {\n      captionDelay: 250,\n      captionsData: 'alt',\n    });\n    galleryList.refresh();\n    if (page < Math.ceil(data.totalHits / 15)) {\n      elements.loadBtn.classList.replace('load-more-hidden', 'load-more');\n    }\n  } catch (err) {\n    err.statusText;\n  } finally {\n    hideLoader();\n  }\n  e.target.reset();\n}\n\nelements.loadBtn.addEventListener('click', onLoadMoreClick);\n\nasync function onLoadMoreClick() {\n  page += 1;\n  showLoader();\n  try {\n    const data = await servisePixabay(searchInput, page);\n    if (page < Math.ceil(data.totalHits / 15)) {\n      elements.loadBtn.classList.replace('load-more-hidden', 'load-more');\n    }\n    if (\n      data.totalHits !== undefined &&\n      page === Math.ceil(data.totalHits / 15)\n    ) {\n      elements.loadBtn.classList.replace('load-more', 'load-more-hidden');\n      iziToast.show({\n        title: 'Error',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topCenter',\n        backgroundColor: 'rgba(252, 249, 249, 1)',\n        messageColor: '#000',\n        zindex: '10000000',\n      });\n    }\n    elements.list.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n    const galleryList = new SimpleLightbox('.gallery a', {\n      captionDelay: 250,\n      captionsData: 'alt',\n    });\n    const { height } = elements.list\n      .querySelector('.gallery_item')\n      .getBoundingClientRect();\n    window.scrollBy({\n      top: height * 2,\n      behavior: 'smooth',\n    });\n    galleryList.refresh();\n  } catch (err) {\n    err.statusText;\n  } finally {\n    hideLoader();\n  }\n}\n"],"names":["servisePixabay","str","page","BASE_URL","API_KEY","params","data","axios","createMarkup","arr","downloads","views","comments","likes","webformatURL","tags","largeImageURL","searchInput","elements","showLoader","hideLoader","onSearchClick","e","iziToast","SimpleLightbox","err","onLoadMoreClick","galleryList","height"],"mappings":"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"}